> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/G6iJxcclmVcXweCQFSwgwA)<table style="overflow-wrap: break-word; empty-cells: show; border-collapse: collapse; table-layout: fixed; width: 528.287px; color: rgb(68, 68, 68); font-family: &quot;PingFang SC&quot;, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Tahoma, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, Simsun, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; visibility: visible;"><tbody style="visibility: visible;"><tr style="overflow-wrap: break-word; visibility: visible;"><td style="overflow-wrap: break-word; font-size: 14px; visibility: visible;"><h2 style="overflow-wrap: break-word; margin: 8px 0px 16px; padding: 0px 0px 0.3em; font-size: 1.5em; font-weight: 600; line-height: 1.25; border-bottom: 2px solid rgb(204, 204, 204); color: rgb(0, 0, 0); visibility: visible;">jy无感取巧思路</h2><blockquote style="overflow-wrap: break-word; margin: 0px; color: rgb(106, 115, 125); padding: 0px 1em; border-left: 0.25em solid rgb(223, 226, 229); visibility: visible;"><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;">目标网站：aHR0cHM6Ly9ndDQuZ2VldGVzdC5jb20v</p></blockquote><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;">本文纯粹取巧！！！对小萌新很不友好</p><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;"><strong style="overflow-wrap: break-word; font-weight: 700; visibility: visible;"><em style="overflow-wrap: break-word; font-style: italic; color: rgb(102, 102, 102); visibility: visible;">本文仅供学习交流，因使用本文内容而产生的任何风险及后果，作者不承担任何责任，一起学习吧</em></strong></p><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;"><strong style="overflow-wrap: break-word; font-weight: 700; visibility: visible;"><em style="overflow-wrap: break-word; font-style: italic; color: rgb(102, 102, 102); visibility: visible;">如有错误，请大佬们指出</em></strong></p><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;"><strong style="overflow-wrap: break-word; font-weight: 700; visibility: visible;"><em style="overflow-wrap: break-word; font-style: italic; color: rgb(102, 102, 102); visibility: visible;">代码均脱敏，如有侵权，请及时联系作者删除</em></strong></p><h3 style="overflow-wrap: break-word; margin: 0px 0px 16px; padding: 0px; font-size: 1.25em; font-weight: 600; line-height: 1.25; border-bottom: 2px solid rgb(204, 204, 204); visibility: visible;">目标确认</h3><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;">记得先将网站的配置设置为无感(一键通过)</p><blockquote style="overflow-wrap: break-word; margin: 0px; color: rgb(106, 115, 125); padding: 0px 1em; border-left: 0.25em solid rgb(223, 226, 229); visibility: visible;"><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;">目标接口：login</p></blockquote><h3 style="overflow-wrap: break-word; margin: 0px 0px 16px; padding: 0px; font-size: 1.25em; font-weight: 600; line-height: 1.25; border-bottom: 2px solid rgb(204, 204, 204); visibility: visible;">响应确认(success and fail )</h3><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;">请求成功返回数据如下：</p><pre style="overflow-wrap: break-word; background-color: rgb(246, 248, 250); border-radius: 6px; padding: 4px; margin-top: 0px; margin-bottom: 15px; overflow: auto; line-height: 1.45; border: none !important; visibility: visible;"><em style="overflow-wrap: break-word; font-style: italic; cursor: pointer; font-size: 12px; color: rgb(51, 102, 153) !important; visibility: visible;">&nbsp;复制代码</em><em style="overflow-wrap: break-word; font-style: italic; cursor: pointer; font-size: 12px; color: rgb(51, 102, 153) !important; visibility: visible;">&nbsp;隐藏代码<br style="overflow-wrap: break-word; visibility: visible;"></em><code data-highlighted="yes" style="overflow-wrap: break-word; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace; background: rgb(0, 0, 0); color: rgb(248, 248, 248); padding: 1em; display: block; overflow-x: auto; visibility: visible;">{<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"result":"success",<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"reason":"",<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"captcha_args":{<br style="visibility: visible;">&nbsp; &nbsp; &nbsp; &nbsp; 省略<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;},<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"status":"success"<br style="visibility: visible;">}</code></pre><p style="overflow-wrap: break-word; margin: 0px 0px 15px; padding: 0px; visibility: visible;">请求失败返回数据如下：</p><pre style="overflow-wrap: break-word; background-color: rgb(246, 248, 250); border-radius: 6px; padding: 4px; margin-top: 0px; margin-bottom: 15px; overflow: auto; line-height: 1.45; border: none !important; visibility: visible;"><em style="overflow-wrap: break-word; font-style: italic; cursor: pointer; font-size: 12px; color: rgb(51, 102, 153) !important; visibility: visible;">&nbsp;复制代码</em><em style="overflow-wrap: break-word; font-style: italic; cursor: pointer; font-size: 12px; color: rgb(51, 102, 153) !important; visibility: visible;">&nbsp;隐藏代码<br style="overflow-wrap: break-word; visibility: visible;"></em><code data-highlighted="yes" style="overflow-wrap: break-word; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace; background: rgb(0, 0, 0); color: rgb(248, 248, 248); padding: 1em; display: block; overflow-x: auto; visibility: visible;">{<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"result":"fail",<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"reason":"pass_token used",<br style="visibility: visible;">&nbsp; &nbsp;&nbsp;"captcha_args":{},<br>&nbsp; &nbsp;&nbsp;"status":"success"<br>}</code></pre><h3 style="overflow-wrap: break-word;margin: 0px 0px 16px;padding: 0px;font-size: 1.25em;font-weight: 600;line-height: 1.25;border-bottom: 2px solid rgb(204, 204, 204);">负载分析</h3><ol style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px 0px 0px 2em;" class="list-paddingleft-1"><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>captcha_id</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>lot_number</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>pass_token</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>gen_time</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>captcha_output</section></li></ol><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">以上参数均来自接口<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">verify</code>(直接搜就知道)，那么逆向目标改变为这个接口。还是一样负载分析(搜索大法)：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">如下图：<img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557480" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYaISZJfb11tpTeibkTBZMcUlVnVmguHKicHqRMYTUDtbxkmS7k0dmwt0Q/640?wx_fmt=png&amp;from=appmsg#imgIndex=0" data-type="png" type="inline" data-original-style="null" data-index="2" data-ratio="0.3475" data-w="1600" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYaISZJfb11tpTeibkTBZMcUlVnVmguHKicHqRMYTUDtbxkmS7k0dmwt0Q/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=0" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="0" data-fail="0"></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><br></ignore_js_op></p><ol style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px 0px 0px 2em;" class="list-paddingleft-1"><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>callback: 这个定死无所谓，本质就是一个<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">geetest_ + 时间戳</code>&nbsp;<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">parseInt(Math.random() * 10000) + (new Date()).valueOf()</code></section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>captcha_id: 这个一个js文件里面，根据不同的验证类型，他的id也不同。这个也可以定死。</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>client_type: 使用平台类型web啥的</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>lot_number: 来自接口<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">load</code>(分析在下面)</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>risk_type: 风险评测ai,这个和验证类型有关</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>payload: 来自接口<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">load</code>(分析在下面)</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>process_token: 来自接口<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">load</code>(分析在下面)</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>payload_protocol: 非重要参数定死即可</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>pt: 非重要参数定死即可</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>w: 一大串不用看，肯定是逆向点</section></li></ol><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">分析接口<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">load</code>，负载如下图：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557481" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQY7nNYKdRjYycowPyVOwUrOqsMXWDP4ZWicDiaojOtKYGRX15Aj9ic8edTA/640?wx_fmt=png&amp;from=appmsg#imgIndex=1" data-type="png" type="inline" data-original-style="null" data-index="3" data-ratio="0.4010989010989011" data-w="364" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQY7nNYKdRjYycowPyVOwUrOqsMXWDP4ZWicDiaojOtKYGRX15Aj9ic8edTA/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=1" _width="364px" style="height: auto !important; visibility: visible !important; width: 364px !important;" alt="图片" data-report-img-idx="1" data-fail="0"></ignore_js_op></p><ol style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px 0px 0px 2em;" class="list-paddingleft-1"><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>callback: 这个定死无所谓，本质就是一个<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">geetest_ + 时间戳</code></section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>captcha_id: 这个一个js文件里面，根据不同的验证类型，他的id也不同。这个也可以定死。</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>challenge: 搜不到，可能是加密参数</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>client_type: 使用平台类型web啥的</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>risk_type: ai</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>lang: 非重要参数定死即可，使用语言</section></li></ol><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">那么目标就先放在<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">load</code>上</p><h3 load="load" style="overflow-wrap: break-word;margin: 0px 0px 16px;padding: 0px;font-size: 1.25em;font-weight: 600;line-height: 1.25;border-bottom: 2px solid rgb(204, 204, 204);"><code style="overflow-wrap: break-word;font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">load</code>逆向</h3><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">关键点就一个challenge,和之前的方法看堆栈后搜索。你要先确认它走了哪些js文件，在通过搜索快速定位。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557482" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYCLZ9KJ66whMgt0BVKOEdnKYY7CLjMVxULz8ia5UdhU6U2KUPp8HlR8A/640?wx_fmt=png&amp;from=appmsg#imgIndex=2" data-type="png" type="inline" data-original-style="null" data-index="4" data-ratio="0.5693548387096774" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYCLZ9KJ66whMgt0BVKOEdnKYY7CLjMVxULz8ia5UdhU6U2KUPp8HlR8A/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=2" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="2" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">是吧，很明确就知道是gt4.js这个文件，而不是上面那个。这就是看栈的好处。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">直接进去打上断点。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557483" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYic5wULFmXFhtbjFmBGrYPeAKy87bUXapkHAclLkwNjiazJEicEz9c1Fiag/640?wx_fmt=png&amp;from=appmsg#imgIndex=3" data-type="png" type="inline" data-original-style="null" data-index="5" data-ratio="0.49681020733652315" data-w="1254" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYic5wULFmXFhtbjFmBGrYPeAKy87bUXapkHAclLkwNjiazJEicEz9c1Fiag/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=3" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="3" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">这里调试比较基础，我直接放结果：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">// challenge就是一个uuid,其实你也可以直接看出来，经验丰富的话<br>var&nbsp;uuid =&nbsp;function&nbsp;() {<br>&nbsp; &nbsp;&nbsp;return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,&nbsp;function&nbsp;(c) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;r =&nbsp;Math.random() *&nbsp;16&nbsp;|&nbsp;0;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;v = c ===&nbsp;'x'&nbsp;? r : (r &amp;&nbsp;0x3&nbsp;|&nbsp;0x8);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;return&nbsp;v.toString(16);<br>&nbsp; &nbsp; &nbsp; &nbsp; });<br>&nbsp; &nbsp; };</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">那我们整理一下。代码如下()，试试发包。</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">import&nbsp;random<br>import&nbsp;re<br>import&nbsp;requests<br><br>defgenerate_uuid():<br>&nbsp; &nbsp; template =&nbsp;'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'<br>&nbsp; &nbsp;&nbsp;defreplace_char(match):<br>&nbsp; &nbsp; &nbsp; &nbsp; c =&nbsp;match.group()<br>&nbsp; &nbsp; &nbsp; &nbsp; r = random.randint(0,&nbsp;15)<br>&nbsp; &nbsp; &nbsp; &nbsp; v = r&nbsp;if&nbsp;c ==&nbsp;'x'else&nbsp;(r &amp;&nbsp;0x3&nbsp;|&nbsp;0x8)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;returnhex(v)[2:] &nbsp;# hex函数返回的结果是'0x...'，取[2:]去掉前缀<br><br>&nbsp; &nbsp;&nbsp;return&nbsp;re.sub(r'[xy]', replace_char, template)<br><br># 测试生成 UUID<br>print(generate_uuid())<br><br>cookies = {<br>&nbsp; &nbsp; 欸嘿<br>}<br><br>headers = {<br>&nbsp; &nbsp; 欸嘿<br>}<br><br>params = {<br>&nbsp; &nbsp; 欸嘿<br>}<br><br>response = requests.get('欸嘿', params=params, cookies=cookies, headers=headers)<br>print(response.text)</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557484" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYOlKbia40xoBooAqLsUDJBocIicSUBWH8FzcAA0fNNsbPfScxt5HrG2Lw/640?wx_fmt=png&amp;from=appmsg#imgIndex=4" data-type="png" type="inline" data-original-style="null" data-index="6" data-ratio="0.2733918128654971" data-w="684" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYOlKbia40xoBooAqLsUDJBocIicSUBWH8FzcAA0fNNsbPfScxt5HrG2Lw/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=4" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="4" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">ok! 这里的逆向基本都解决了。那我们的重点又回到接口<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">verify</code>。基本上重点就是这个w了。那么还是老套路，看栈,然后可以搜索一些这些值看看能不能快速定位：<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">w:</code>,<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">\u0077</code>。如果发现都不行，那么就老老实实的一步步跟。<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">w:</code>可以搜到入口，打赏断点看看。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557485" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQY5shLKgxjgZpwCkcytd9hFVR71ADKOHWVhibE9LNTNqQTpUmiaHF4eiaww/640?wx_fmt=png&amp;from=appmsg#imgIndex=5" data-type="png" type="inline" data-original-style="null" data-index="7" data-ratio="1.164855072463768" data-w="552" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQY5shLKgxjgZpwCkcytd9hFVR71ADKOHWVhibE9LNTNqQTpUmiaHF4eiaww/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=5" _width="552px" style="height: auto !important; visibility: visible !important; width: 552px !important;" alt="图片" data-report-img-idx="5" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">&lt;!-- 将<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">gcaptch4.js</code>代码复制下来，通过v神(v_jstool)开源的工具，简单处理一下(打开配置页面仅变量压缩)。将代码覆盖。方便后续调试。 --&gt;</p><h3 w="w" style="overflow-wrap: break-word;margin: 0px 0px 16px;padding: 0px;font-size: 1.25em;font-weight: 600;line-height: 1.25;border-bottom: 2px solid rgb(204, 204, 204);"><code style="overflow-wrap: break-word;font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">w</code>逆向</h3><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">定位到如下：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557486" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYsdcLa98YT2LYbvzqqQcAYmJBicv8BdFIdQB7Eva7wuVGbLfhRR9XYVA/640?wx_fmt=png&amp;from=appmsg#imgIndex=6" data-type="png" type="inline" data-original-style="null" data-index="8" data-ratio="0.33131313131313134" data-w="990" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYsdcLa98YT2LYbvzqqQcAYmJBicv8BdFIdQB7Eva7wuVGbLfhRR9XYVA/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=6" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="6" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">我把关键代码摘出来分析，如下：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">var&nbsp;_ᖚᖆᖀᖃ = (0,<br>&nbsp; &nbsp; _ᖆᕿᖄᖀ[_ᖀᖄᕴᖄ(9)])(_ᕹᖀᖃᖙ[_ᖄᕿᖚᕺ(9)][_ᖀᖄᕴᖄ(587)](_ᕶᖉᖃᕾ), _ᖉᕹᕺᖀ)<br>&nbsp; &nbsp; &nbsp; &nbsp; , u = {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;callback: _ᖀᖄᕴᖄ(52),<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;captcha_id: _ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(542)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;challenge: _ᕶᖆᕷᕵ[_ᖄᕿᖚᕺ(603)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;client_type: _ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(629)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;lot_number: _ᕶᖆᕷᕵ[_ᖄᕿᖚᕺ(461)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;risk_type: _ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(666)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;payload: _ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(692)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;process_token: _ᕶᖆᕷᕵ[_ᖄᕿᖚᕺ(697)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;payload_protocol: _ᕶᖆᕷᕵ[_ᖄᕿᖚᕺ(644)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pt: _ᕶᖆᕷᕵ[_ᖄᕿᖚᕺ(641)],<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;w: _ᖚᖆᖀᖃ<br>&nbsp; &nbsp; };<br>// 这里很明显w --&gt; _ᖚᖆᖀᖃ --&gt; (0,_ᖆᕿᖄᖀ[_ᖀᖄᕴᖄ(9)])(_ᕹᖀᖃᖙ[_ᖄᕿᖚᕺ(9)][_ᖀᖄᕴᖄ(587)](_ᕶᖉᖃᕾ), _ᖉᕹᕺᖀ)</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">那么关键就是解出这部分的逻辑(这里你可以解混淆，然后通过花瓶替换，我这边讲解扎实的基本功就不替换了)。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">核心代码讲解如下：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">(0,_ᖆᕿᖄᖀ[_ᖀᖄᕴᖄ(9)])(_ᕹᖀᖃᖙ[_ᖄᕿᖚᕺ(9)][_ᖀᖄᕴᖄ(587)](_ᕶᖉᖃᕾ), _ᖉᕹᕺᖀ)<br>// 控制台看看<br>(0,_ᖆᕿᖄᖀ['default'])(_ᕹᖀᖃᖙ['default']['stringify'](_ᕶᖉᖃᕾ), _ᖉᕹᕺᖀ)<br>//相当于(0,_ᖆᕿᖄᖀ['default'])这个函数传入，两个值，一个_ᕹᖀᖃᖙ['default']['stringify'](_ᕶᖉᖃᕾ)，一个_ᖉᕹᕺᖀ<br>// 第一个值是'{"device_id":"","lot_number":"欸嘿","pow_msg":"欸嘿","pow_sign":"欸嘿","geetest":"captcha","lang":"zh","ep":"123","biht":"1426265548","gee_guard":{"roe":{"aup":"3","sep":"3","egp":"3","auh":"3","rew":"3","snh":"3","res":"3","cdc":"3"}},"So89":"1AnD","2e424091":{"2a4b":"b2e4"},"em":{"ph":0,"cp":0,"ek":"11","wd":1,"nt":0,"si":0,"sc":0}}'<br>// 第二个是一个对象</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">我们现象目光放在入参这个字符串(json转的)，分析构造。这里我看到<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">stringify</code>和后面这个<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">_ᕶᖉᖃᕾ</code>的输出，我就猜想了一下。如下：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557487" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYCTibEd9xnlFVS0CkJ7z5PkCu1sKlU2VApHdE3SicwEemqRQ6UQA1OX3Q/640?wx_fmt=png&amp;from=appmsg#imgIndex=7" data-type="png" type="inline" data-original-style="null" data-index="9" data-ratio="0.22135102533172496" data-w="1658" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYCTibEd9xnlFVS0CkJ7z5PkCu1sKlU2VApHdE3SicwEemqRQ6UQA1OX3Q/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=7" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="7" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">那么我们接着看<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">_ᕶᖉᖃᕾ</code>是咋来的，简单分析一下：</p><ol style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px 0px 0px 2em;" class="list-paddingleft-1"><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>device_id ：为空</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>lot_number ：load包里面有</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>pow_msg： 能搜到,不多，全部打上断点</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>pow_sign：能搜到,不多，全部打上断点</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>geetest： 非重要参数</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>lang：非重要参数</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>ep：非重要参数</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>biht：暂时不清楚</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>gee_guard，So89，2e424091，em：暂时不清楚</section></li></ol><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">直接打上断点，结果如下：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557488" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYONjkPuVw2wXJ62vLpIOndRT6ZjXMnCziceJfmibAAic1uVJeVicxtZAibxA/640?wx_fmt=png&amp;from=appmsg#imgIndex=8" data-type="png" type="inline" data-original-style="null" data-index="10" data-ratio="0.47571606475716066" data-w="803" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYONjkPuVw2wXJ62vLpIOndRT6ZjXMnCziceJfmibAAic1uVJeVicxtZAibxA/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=8" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="8" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">我把核心代码提取出来讲解一下：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">{<br>&nbsp; &nbsp;&nbsp;pow_msg: _ᖄᖆᖗᕺ + h,<br>&nbsp; &nbsp;&nbsp;pow_sign: p<br>}<br>// 很明显搞清楚,让我们一步步还原。<br><br>_ᖄᖆᖗᕺ = _ᕶᖆᕷᕵ + _ᕶᖃᖁᕹ(111) + _ᖀᖄᕴᖄ + _ᕸᖙᕹᕷ(111) + _ᖄᕿᖚᕺ + _ᕶᖃᖁᕹ(111) + _ᕹᕿᖆᖀ + _ᕶᖃᖁᕹ(111) + _ᕶᕴᕹᕶ + _ᕶᖃᖁᕹ(111) + _ᕶᖉᖃᕾ + _ᕸᖙᕹᕷ(111) + _ᕿᕵᖆᕾ + _ᕸᖙᕹᕷ(111);<br><br>// 简单还原一下：<br>_ᖄᖆᖗᕺ = _ᕶᖆᕷᕵ +&nbsp;'|'&nbsp;+ _ᖀᖄᕴᖄ +&nbsp;'|'&nbsp;+ _ᖄᕿᖚᕺ +&nbsp;'|'&nbsp;+ _ᕹᕿᖆᖀ +&nbsp;'|'&nbsp;+ _ᕶᕴᕹᕶ +&nbsp;'|'&nbsp;+ _ᕶᖉᖃᕾ +&nbsp;'|'&nbsp;+ _ᕿᕵᖆᕾ +&nbsp;'|';<br>// 那么这个参数就是几个值同 '|' 拼接而成的<br>// _ᕶᖆᕷᕵ --&gt; 1 定死<br>// _ᖀᖄᕴᖄ --&gt; 0 定死<br>// _ᖄᕿᖚᕺ --&gt; 'md5' 看情况，他有三种模式，有md5,sha1,sha256 这个是决定 p 的生成的。<br>// _ᕹᕿᖆᖀ --&gt; '2025-04-16T14:29:07.516729+08:00' 一个时间戳还原代码后面写。<br>// _ᕶᕴᕹᕶ --&gt; captcha_id<br>// _ᕶᖉᖃᕾ --&gt; lot_number<br>// _ᕿᕵᖆᕾ --&gt; ''<br><br>h = _ᕺᖗᕾᖗ['guid']()&nbsp;// 跟栈你会发现他就是 e() + e() + e() + e()<br>functione() {<br>&nbsp; &nbsp;&nbsp;var&nbsp;_ᖚᖆᖀᖃ = _ᖀᕴᖘᕺ.$_Dr()[0][7];<br>&nbsp; &nbsp;&nbsp;for&nbsp;(; _ᖚᖆᖀᖃ !== _ᖀᕴᖘᕺ.$_Dr()[3][6]; ) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;switch&nbsp;(_ᖚᖆᖀᖃ) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;case&nbsp;_ᖀᕴᖘᕺ.$_Dr()[3][7]:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;return&nbsp;(65536&nbsp;* (1&nbsp;+&nbsp;Math['random']()) |&nbsp;0)['toString'](16)['substring'](1);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;break<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br>//这个函数看着那么吓人，其实就执行了一步就是(65536 * (1 + Math['random']()) | 0)['toString'](16)['substring'](1);<br>//所以h函数就可以写为：<br>functione(){<br>&nbsp; &nbsp;&nbsp;return&nbsp;(65536&nbsp;* (1&nbsp;+&nbsp;Math['random']()) |&nbsp;0)['toString'](16)['substring'](1);<br>}<br>h =&nbsp;e() +&nbsp;e() +&nbsp;e() +&nbsp;e()<br><br>// 接着看p，这个你看到分支你就笑吧。搞清楚入参，带入算算，如果是标准加密就爽了，下面这个都不用扣算法了。<br>// 入参就是pow_msg<br>switch&nbsp;(_ᖄᕿᖚᕺ) {<br>&nbsp; &nbsp;&nbsp;case'md5':<br>&nbsp; &nbsp; &nbsp; &nbsp; p = (new&nbsp;(_ᖉᕹᕺᖀ[_ᕸᖙᕹᕷ(9)][_ᕸᖙᕹᕷ(771)]))[_ᕶᖃᖁᕹ(793)](l);<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;break;<br>&nbsp; &nbsp;&nbsp;case'sha1':<br>&nbsp; &nbsp; &nbsp; &nbsp; p = (new&nbsp;(_ᖉᕹᕺᖀ[_ᕸᖙᕹᕷ(9)][_ᕸᖙᕹᕷ(789)]))[_ᕶᖃᖁᕹ(793)](l);<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;break;<br>&nbsp; &nbsp;&nbsp;case'sha256':<br>&nbsp; &nbsp; &nbsp; &nbsp; p = (new&nbsp;(_ᖉᕹᕺᖀ[_ᕶᖃᖁᕹ(9)][_ᕶᖃᖁᕹ(778)]))[_ᕸᖙᕹᕷ(793)](l)<br>}<br><br>// 我们走入分支直接测试即可<br>// (new (_ᖉᕹᕺᖀ[_ᕸᖙᕹᕷ(9)][_ᕸᖙᕹᕷ(771)]))[_ᕶᖃᖁᕹ(793)]('12345') --&gt; &nbsp;'827ccb0eea8a706c4c34a16891f84e7b' 标准小写md5-32位<br><br>// 那么这部分加密我们就完成了</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">继续分析参数：</p><ol style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px 0px 0px 2em;" class="list-paddingleft-1"><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>So89 定值，我刷新了几次没变</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>2e424091 --&gt; 变值，自己本身就是，这个参数就在上面可以直接看到</section></li></ol><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">继续分析,本人还是继续从代码角度分析：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">var&nbsp;i = (0,_ᕸᖙᕹᕷ[_ᖄᕿᖚᕺ(68)])(_ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(693)], _ᕶᖆᕷᕵ[_ᖄᕿᖚᕺ(461)]),&nbsp;<br>r = (0,_ᕸᖙᕹᕷ[_ᖄᕿᖚᕺ(68)])(_ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(652)], _ᕶᖆᕷᕵ[_ᖀᖄᕴᖄ(461)])</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">规律如下图：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557489" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYZnuQGjj2fMick3lmvGjf8NHMUiaIyOhgqsKicWAl0UaRzIkLGFBF6bz4w/640?wx_fmt=png&amp;from=appmsg#imgIndex=9" data-type="png" type="inline" data-original-style="null" data-index="11" data-ratio="0.4039179104477612" data-w="1072" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYZnuQGjj2fMick3lmvGjf8NHMUiaIyOhgqsKicWAl0UaRzIkLGFBF6bz4w/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=9" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="9" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">打上断点，让我们看看他的逻辑</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">var&nbsp;i = _ᕸᖙᕹᕷ['getStringByIndexes'](_ᕶᖆᕷᕵ['lot'],_ᕶᖆᕷᕵ['lotNumber']),<br>r = _ᕸᖙᕹᕷ['getStringByIndexes'](_ᕶᖆᕷᕵ['lotRes'],_ᕶᖆᕷᕵ['lotNumber'])<br><br>// lot_number 为入参<br>function&nbsp;_ᖚᖆᖀᖃ(_ᕶᖉᖃᕾ, _ᕶᕴᕹᕶ) {<br>&nbsp; &nbsp;&nbsp;// var _ᖄᕿᖚᕺ = _ᖀᕴᖘᕺ.$_Cl<br>&nbsp; &nbsp;&nbsp;// &nbsp; &nbsp; , _ᕶᖆᕷᕵ = ["$_DBF_"].concat(_ᖄᕿᖚᕺ)<br>&nbsp; &nbsp;&nbsp;// &nbsp; &nbsp; , _ᖀᖄᕴᖄ = _ᕶᖆᕷᕵ[1];<br>&nbsp; &nbsp;&nbsp;// _ᕶᖆᕷᕵ.shift(); &nbsp;这部分你都不用看，没啥用，ob混淆解混用的<br>&nbsp; &nbsp;&nbsp;var&nbsp;_ᕹᕿᖆᖀ = _ᕶᖆᕷᕵ[0];<br>&nbsp; &nbsp;&nbsp;return&nbsp;_ᕶᖉᖃᕾ[_ᖄᕿᖚᕺ(48)](function(_ᖚᖆᖀᖃ) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;_ᕶᖉᖃᕾ = _ᖀᕴᖘᕺ.$_Cl<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , _ᖄᕿᖚᕺ = ["$_DCAl"].concat(_ᕶᖉᖃᕾ)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , _ᕶᖆᕷᕵ = _ᖄᕿᖚᕺ[1];<br>&nbsp; &nbsp; &nbsp; &nbsp; _ᖄᕿᖚᕺ.shift();<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;_ᖀᖄᕴᖄ = _ᖄᕿᖚᕺ[0];<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;return&nbsp;_ᖚᖆᖀᖃ[_ᕶᖉᖃᕾ(48)](function(_ᖚᖆᖀᖃ) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;_ᕶᖉᖃᕾ = _ᖀᕴᖘᕺ.$_Cl<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , _ᖄᕿᖚᕺ = ["$_DCFk"].concat(_ᕶᖉᖃᕾ)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , _ᕶᖆᕷᕵ = _ᖄᕿᖚᕺ[1];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _ᖄᕿᖚᕺ.shift();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;_ᖀᖄᕴᖄ = _ᖄᕿᖚᕺ[0];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;var&nbsp;_ᕹᕿᖆᖀ = _ᖚᖆᖀᖃ[_ᕶᖉᖃᕾ(64)]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , _ᖉᕹᕺᖀ = _ᕹᕿᖆᖀ[0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , _ᕺᖗᕾᖗ =&nbsp;1&nbsp;&lt; _ᕹᕿᖆᖀ[_ᕶᖆᕷᕵ(84)] ? _ᕹᕿᖆᖀ[1] +&nbsp;1&nbsp;: _ᕹᕿᖆᖀ[0] +&nbsp;1;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;return&nbsp;_ᕶᕴᕹᕶ[_ᕶᖆᕷᕵ(74)](_ᖉᕹᕺᖀ, _ᕺᖗᕾᖗ)<br>&nbsp; &nbsp; &nbsp; &nbsp; })[_ᕶᖆᕷᕵ(93)](_ᕶᖆᕷᕵ(52))<br>&nbsp; &nbsp; })[_ᖄᕿᖚᕺ(93)](_ᖄᕿᖚᕺ(92))<br>}<br>// 这里这个代码其实不用跟的这么麻烦，我们简单跟一下找到如下：<br><br>// return new _ᖉᕹᕺᖀ(_ᖀᖄᕴᖄ[_ᕶᖉᖃᕾ(173)](_ᖚᖆᖀᖃ));</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">放个图，你可以看看我是如何猜想和思考的。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557490" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYpqlPlt3ZhP0wChEFjnTtESyiazzqzhXlVtncTEzVZ9X9GvObWs0RCcg/640?wx_fmt=png&amp;from=appmsg#imgIndex=10" data-type="png" type="inline" data-original-style="null" data-index="12" data-ratio="1.2289156626506024" data-w="664" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYpqlPlt3ZhP0wChEFjnTtESyiazzqzhXlVtncTEzVZ9X9GvObWs0RCcg/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=10" _width="664px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="10" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">我的猜想是它按照固定数组在字符串中取值。让我们着手试试。结果如下：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557491" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYAAL0XicbmjxiaLYEtQRTrjUaicE4XFTGiaV4LCL0z75GUyNib3lgDPr4t0w/640?wx_fmt=png&amp;from=appmsg#imgIndex=11" data-type="png" type="inline" data-original-style="null" data-index="13" data-ratio="0.18218352310783656" data-w="1493" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYAAL0XicbmjxiaLYEtQRTrjUaicE4XFTGiaV4LCL0z75GUyNib3lgDPr4t0w/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=11" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="11" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">那么r也是，结果如下：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557492" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYSrghcflExqwXwg9eBBodOvibQnFp4KILav58k8oocWtMeEANpUQST7g/640?wx_fmt=png&amp;from=appmsg#imgIndex=12" data-type="png" type="inline" data-original-style="null" data-index="14" data-ratio="0.5147783251231527" data-w="406" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYSrghcflExqwXwg9eBBodOvibQnFp4KILav58k8oocWtMeEANpUQST7g/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=12" _width="406px" style="height: auto !important; visibility: visible !important; width: 406px !important;" alt="图片" data-report-img-idx="12" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">那么入参已经全部弄清楚了。接下来就是加密。还是一样层层分析。</p><h3 style="overflow-wrap: break-word;margin: 0px 0px 16px;padding: 0px;font-size: 1.25em;font-weight: 600;line-height: 1.25;border-bottom: 2px solid rgb(204, 204, 204);">逆向算法分析</h3><blockquote style="overflow-wrap: break-word;margin: 0px;color: rgb(106, 115, 125);padding: 0px 1em;border-left: 0.25em solid rgb(223, 226, 229);"><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">_ᖆᕿᖄᖀ['default'](_ᕹᖀᖃᖙ['default']['stringify'](_ᕶᖉᖃᕾ), _ᖉᕹᕺᖀ)</code></p></blockquote><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><strong style="overflow-wrap: break-word;font-weight: 700;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(102, 102, 102);">这是全文最难的地方。</em></strong></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557493" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYtiaIFndtgibIopzv1icJzGJtddPxoaoDDLfkXOWibqialPxQmv8YxmaOgCA/640?wx_fmt=png&amp;from=appmsg#imgIndex=13" data-type="png" type="inline" data-original-style="null" data-index="15" data-ratio="0.5687757909215956" data-w="1454" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYtiaIFndtgibIopzv1icJzGJtddPxoaoDDLfkXOWibqialPxQmv8YxmaOgCA/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=13" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="13" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">你看看我找了什么，<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">key,iv</code>???</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557494" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYib5RwUNovd4POLrcgYbL7ZDErvmr5liaibC91u327YIicfCibXQgK3QlHIw/640?wx_fmt=png&amp;from=appmsg#imgIndex=14" data-type="png" type="inline" data-original-style="null" data-index="16" data-ratio="0.8368580060422961" data-w="993" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYib5RwUNovd4POLrcgYbL7ZDErvmr5liaibC91u327YIicfCibXQgK3QlHIw/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=14" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="14" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">这不会是一个标准的ase吧？？？不急，先猜想，后验证，大不了不对在扣呗。有的是机会。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">把相关信息保存一下,我们猜测是：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">猜想加密算法2&nbsp;--&gt; ase<br>ase : &nbsp;模式&nbsp;cbc<br>&nbsp; &nbsp; &nbsp; &nbsp;key&nbsp;e() +&nbsp;e() +&nbsp;e() +&nbsp;e()随机<br>&nbsp; &nbsp; &nbsp; &nbsp;iv 0000000000000000</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">我怀着好奇把1里面的<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">new (_ᕶᖃᖁᕹ[_ᖄᕿᖚᕺ(9)])</code>输出看了看，欸，这不是rsa的标志吗(每次结果都不一样我就在怀疑了，当然也可能是时间戳或者其他算法)？但是我看到了&nbsp;<code style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;padding: 0.2em 0.4em;margin: 0px;background-color: rgba(27, 31, 35, 0.05);border-radius: 6px;">65537</code>&nbsp;这是一个常用的 RSA 公钥指数。而且，它的数组跟了大数里面跟了一个小数37，正好是前面37的个数，这里就相当于表示这个大整数 n 拆分为 37 个段。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">猜归猜，我们还是要搞清楚整体流程：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">// 初始化前面的加密算法之后，我们一步步看看干了什么，我把核心流程抽取出来了<br>var&nbsp;o = _ᖀᖄᕴᖄ(878) === _ᕺᖗᕾᖗ[_ᖀᖄᕴᖄ(641)]&nbsp;// true<br>&nbsp; &nbsp; , a = _ᕺᖗᕾᖗ[_ᖄᕿᖚᕺ(641)] &nbsp;// '1'&nbsp;<br>&nbsp; &nbsp; , _ = _ᖆᖚᖉᕾ[a]['asymmetric']['encrypt'](_ᖂᖈᖗᕾ);&nbsp;// 这里把ase的key，放到加密算法1里面加密<br>while&nbsp;(o &amp;&amp; (!_ ||&nbsp;256&nbsp;!== _[_ᖀᖄᕴᖄ(84)])) &nbsp;// false 不走<br>&nbsp; &nbsp; _ᖂᖈᖗᕾ = (0,<br>&nbsp; &nbsp; _ᕴᕺᖙᕷ[_ᖄᕿᖚᕺ(58)])(),<br>&nbsp; &nbsp; _ = (new&nbsp;(_ᕶᖃᖁᕹ[_ᖄᕿᖚᕺ(9)]))[_ᖄᕿᖚᕺ(955)](_ᖂᖈᖗᕾ);<br><br>var&nbsp;u = _ᖆᖚᖉᕾ[a]['symmetrical']['encrypt'](_ᕶᖉᖃᕾ, _ᖂᖈᖗᕾ); &nbsp;// ase的key 和最开始的入参计算加密，生成字节数组<br>return&nbsp;(0,<br>_ᕴᕺᖙᕷ['arrayToHex'])(u) + _&nbsp;// 两个加密结果相加</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">这里结合之前的分析，我们猜测是流程是：</p><ol style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px 0px 0px 2em;" class="list-paddingleft-1"><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>_ 是 随机key通过rsa加密</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>u 是 之前的入参和随机key 进行aes加密</section></li><li style="overflow-wrap: break-word;margin: 0px 0px 0px 2px;padding: 0px;list-style-type: decimal;"><section>最后将两个结果合并返回。</section></li></ol><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">第一步我们只需要把自己生成的rsa给他替换了，看看能不能过就知道是否是正确的(这个方法很常用哦)。我测过了，是可以过的。代码如下：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;"><br>import&nbsp;random<br>from&nbsp;Crypto.Util.number&nbsp;import&nbsp;bytes_to_long, long_to_bytes<br><br>n_segments = {<br>&nbsp; &nbsp; 欸嘿<br>}<br><br># 还原 n（拼接成一个大整数）<br>n =&nbsp;0<br>for&nbsp;i&nbsp;inrange(n_segments["t"] -&nbsp;1, -1, -1):<br>&nbsp; &nbsp; n = (n &lt;&lt;&nbsp;28) + n_segments[i]<br><br># 公钥指数<br>e =&nbsp;65537<br><br># 待加密明文<br>plaintext =&nbsp;"2989a61219603dc6"<br><br># ---- UTF-8 倒序编码 ----<br>defreverse_utf8_bytes(text):<br>&nbsp; &nbsp; result = []<br>&nbsp; &nbsp;&nbsp;for&nbsp;c&nbsp;inreversed(text):<br>&nbsp; &nbsp; &nbsp; &nbsp; code =&nbsp;ord(c)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;if&nbsp;code &lt;&nbsp;0x80:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result.insert(0, code)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;elif&nbsp;code &lt;&nbsp;0x800:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result.insert(0,&nbsp;0xC0&nbsp;| (code &gt;&gt;&nbsp;6))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result.insert(1,&nbsp;0x80&nbsp;| (code &amp;&nbsp;0x3F))<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result.insert(0,&nbsp;0xE0&nbsp;| (code &gt;&gt;&nbsp;12))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result.insert(1,&nbsp;0x80&nbsp;| ((code &gt;&gt;&nbsp;6) &amp;&nbsp;0x3F))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result.insert(2,&nbsp;0x80&nbsp;| (code &amp;&nbsp;0x3F))<br>&nbsp; &nbsp;&nbsp;return&nbsp;result<br><br># ---- 构造带 PKCS<a class="wx_topic_link" topic-id="mjz5vypf-rydafh" style="color: #576B95 !important;" data-topic="1" href="javascript:;">#1</a>&nbsp;padding 的明文块 ----<br>defrsa_pkcs1_v15_pad(plaintext:&nbsp;str, total_length:&nbsp;int&nbsp;=&nbsp;128) -&gt;&nbsp;bytes:<br>&nbsp; &nbsp; data = reverse_utf8_bytes(plaintext)<br>&nbsp; &nbsp; ps_length = total_length -&nbsp;len(data) -&nbsp;3&nbsp;&nbsp;# 3 = 0x00 0x02 0x00<br><br>&nbsp; &nbsp;&nbsp;if&nbsp;ps_length &lt;&nbsp;8:<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;raise&nbsp;ValueError("Message too long")<br><br>&nbsp; &nbsp;&nbsp;# 随机非零 padding<br>&nbsp; &nbsp; padding = []<br>&nbsp; &nbsp;&nbsp;whilelen(padding) &lt; ps_length:<br>&nbsp; &nbsp; &nbsp; &nbsp; b = random.randint(1,&nbsp;255)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;if&nbsp;b !=&nbsp;0:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding.append(b)<br><br>&nbsp; &nbsp; padded =&nbsp;bytearray()<br>&nbsp; &nbsp; padded.append(0x00)<br>&nbsp; &nbsp; padded.append(0x02)<br>&nbsp; &nbsp; padded.extend(padding)<br>&nbsp; &nbsp; padded.append(0x00)<br>&nbsp; &nbsp; padded.extend(data)<br><br>&nbsp; &nbsp;&nbsp;returnbytes(padded)<br><br># ---- 构造明文块并加密 ----<br>padded_bytes = rsa_pkcs1_v15_pad(plaintext,&nbsp;128)<br>m = bytes_to_long(padded_bytes) &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;# 明文块 -&gt; 整数 M<br>c =&nbsp;pow(m, e, n) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;# 执行 C = M^e mod n<br>cipher_hex =&nbsp;hex(c)[2:] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;# 转十六进制去掉 '0x' 前缀<br><br># 可选补0，补齐256位 hex 字符<br>iflen(cipher_hex) %&nbsp;2&nbsp;!=&nbsp;0:<br>&nbsp; &nbsp; cipher_hex =&nbsp;'0'&nbsp;+ cipher_hex<br><br>print("加密前（明文）:", plaintext)<br>print("Padding 后字节（十六进制）:", padded_bytes.hex())<br>print("加密后（十六进制）:", cipher_hex)</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">第二步，看看这个ase是否猜测正确。我们先简单编写一些aes代码，如下：</p><pre style="overflow-wrap: break-word;background-color: rgb(246, 248, 250);border: none !important;border-radius: 6px;padding: 4px;margin-top: 0px;margin-bottom: 15px;overflow: auto;line-height: 1.45;"><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;复制代码</em><em style="overflow-wrap: break-word;font-style: italic;color: rgb(51, 102, 153) !important;cursor: pointer;font-size: 12px;">&nbsp;隐藏代码<br style="overflow-wrap: break-word;"></em><code data-highlighted="yes" style="overflow-wrap: break-word;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;background: rgb(0, 0, 0);color: rgb(248, 248, 248);padding: 1em;display: block;overflow-x: auto;">from&nbsp;Crypto.Cipher&nbsp;import&nbsp;AES<br>from&nbsp;Crypto.Util.Padding&nbsp;import&nbsp;pad<br>import&nbsp;binascii<br><br># 参数还原<br>plaintext =&nbsp;'欸嘿'<br>key_str =&nbsp;'b903bbf7a0871a11'<br>iv_str =&nbsp;'0000000000000000'<br><br>key = key_str.encode('utf-8')<br>iv = iv_str.encode('utf-8')<br><br># 补足 16 字节<br>key = key.ljust(16,&nbsp;b'\x00')<br>iv = iv.ljust(16,&nbsp;b'\x00')<br><br># AES CBC PKCS7 加密<br>cipher = AES.new(key, AES.MODE_CBC, iv)<br>ciphertext = cipher.encrypt(pad(plaintext.encode('utf-8'), AES.block_size))<br><br># 输出 hex 串用于比对<br>hex_output = binascii.hexlify(ciphertext).decode()<br>print(hex_output)</code></pre><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">结果如下：</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;"><ignore_js_op style="overflow-wrap: break-word;"><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="504557495" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYBdYyIcPKxeuYyCL8gYE461icJLNcqRvBjibYf6IkzQL9jOMqHWNFCkVw/640?wx_fmt=png&amp;from=appmsg#imgIndex=15" data-type="png" type="inline" data-original-style="null" data-index="17" data-ratio="0.2261904761904762" data-w="1176" src="https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYBdYyIcPKxeuYyCL8gYE461icJLNcqRvBjibYf6IkzQL9jOMqHWNFCkVw/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=15" _width="677px" style="height: auto !important; visibility: visible !important; width: 655px !important;" alt="图片" data-report-img-idx="15" data-fail="0"></ignore_js_op></p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">成功了，不用扣代码了。爽！不过这个扣的难度不高。认真一点没啥问题。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">最后的结果就是--&gt; 两个结果合并返回。</p><p style="overflow-wrap: break-word;margin: 0px 0px 15px;padding: 0px;">最后测试一下，嗯哼，没毛病。无感相较于滑块简单点。滑块还有轨迹收集。</p></td></tr></tbody></table>

  

  

  

  

  

**·** **今 日 推 荐** **·**

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYjjzMsjqZprnu0jicBY6X5ia0BRCSaN8tEmFDv0libdv9XGCwO1VHDF4Zw/640?wx_fmt=jpeg&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=16)

  

  

本文内容来自网络，如有侵权请联系删除

![图片](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rkjtS9ngP4EPbXbbzAQaQYuMPoPmFLXDe2I9PiaQHgcLlCf8mJHVibP2NUCEgEx60TdicH33r7Hcmiaw/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=17)